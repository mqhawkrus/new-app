<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Stress Analysis App</title>
  <link rel="icon" type="image/x-icon" href="StressAppIcon.ico">
  <style>
    /* Modern Style Update for Stress Analysis App */

/* Global Reset & Base Styles */
* { 
  box-sizing: border-box; 
  margin: 0; 
  padding: 0; 
}

html { 
  scroll-behavior: smooth; 
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f0f4f8;
  color: #334155;
  transition: background-color 0.5s ease, color 0.5s ease;
  line-height: 1.6;
}

/* Global Transitions */
body, header, .sidebar, .results-section, .container, button, 
.data-entry-tab, .data-entry-tab-header, .sidebar-overlay {
  transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
}
.video-container {
    width: 300px; /* Adjust size */
    height: 300px; /* Keep width and height equal for a perfect circle */
    margin: 20px auto; /* Centers the video */
    overflow: hidden;
    border-radius: 50%; /* Makes it circular */
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Optional shadow for a smooth look */
}

.video-container video {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures the video fills the circle */
    border-radius: 50%;
    pointer-events: none; /* Disables controls */
}
/* Ripple effect animation */
@keyframes ripple {
  from { transform: translate(-50%, -50%) scale(0); opacity: 0.5; }
  to { transform: translate(-50%, -50%) scale(3); opacity: 0; }
}

.ripple {
  position: fixed;
  border: 2px solid rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  pointer-events: none;
  transform: translate(-50%, -50%) scale(0);
  animation: ripple 0.6s linear forwards;
  z-index: 10000;
  width: 20px;
  height: 20px;
}

/* Blue Theme */
body.theme-blue {
  background: #e3f2fd;
  color: #0d47a1;
}
body.theme-blue header {
  background: linear-gradient(135deg, #42a5f5, #1e88e5);
}
body.theme-blue .sidebar {
  background: linear-gradient(180deg, #1565c0, #1e88e5);
  color: #e3f2fd;
}

/* Green Theme */
body.theme-green {
  background: #e8f5e9;
  color: #1b5e20;
}
body.theme-green header {
  background: linear-gradient(135deg, #66bb6a, #257829);
}
body.theme-green .sidebar {
  background: linear-gradient(180deg, #43b349, #388e3c);
  color: #e8f5e9;
}

/* Red Theme */
body.theme-red {
  background: #ffffff;
  color: #ff9595;
}
body.theme-red header {
  background: linear-gradient(135deg, #ef5090, #e53564);
}
body.theme-red .sidebar {
  background: linear-gradient(180deg, #aa2828, #760202);
  color: #ffebee;
}

/* App Container */
.app-container { 
  display: flex; 
  height: 100vh; 
}

/* Sidebar Styling */
.sidebar {
  width: 70px; 
  background: linear-gradient(180deg, #225c89, #11324b);
  color: #ecf0f1;
  padding: 20px 10px; 
  font-weight: 500; 
  transition: width 0.3s ease;
  white-space: nowrap; 
  overflow: hidden; 
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
  z-index: 10;
}

.sidebar:hover { 
  width: 280px; 
}

.sidebar h2 { 
  text-align: center; 
  margin-bottom: 30px; 
  opacity: 0; 
  transition: opacity 0.2s ease 0.1s; 
  font-weight: 600;
  letter-spacing: 1px;
}

.sidebar:hover h2 { 
  opacity: 1; 
}

.sidebar ul { 
  list-style: none; 
  padding: 0; 
  margin-top: 20px;
}

.sidebar ul li {
  padding: 14px 16px;
  margin: 8px 0; 
  cursor: pointer; 
  border-radius: 8px;
  transition: all 0.3s ease; 
  opacity: 0;
  display: flex;
  align-items: center;
}

.sidebar:hover ul li { 
  opacity: 1; 
}

.sidebar ul li:hover { 
  background: rgba(255, 255, 255, 0.1);
  transform: translateX(5px);
}

/* Main Content Area */
.main-content {
  flex-grow: 1; 
  display: flex; 
  flex-direction: column; 
  position: relative;
  box-shadow: 0 0 15px rgba(0,0,0,0.05);
  border-radius: 0;
  overflow: hidden;
}

/* Header Animation */
@keyframes gradientPulse {
  0% {
    background-position: 0% 50%;
    text-shadow: 0 0 10px rgba(255,255,255,0.3);
  }
  50% {
    background-position: 100% 50%;
    text-shadow: 0 0 20px rgba(255,255,255,0.6), 0 0 30px rgba(255,255,255,0.4);
  }
  100% {
    background-position: 0% 50%;
    text-shadow: 0 0 10px rgba(255,255,255,0.3);
  }
}

.wavy-text {
  background-image: linear-gradient(
    90deg,
    #ffffff 0%,
    #a0d8ff 25%,
    #1aa4ff 50%,
    #a0d8ff 75%,
    #ffffff 100%
  );
  background-size: 400% 400%;
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  animation: gradientPulse 8s ease infinite;
  letter-spacing: 2px;
  font-weight: 700;
  font-size: 70px;
}

/* Header */
header {
  display: flex; 
  align-items: center;
  justify-content: space-between;
  gap: 30px; /* Adjust the gap value as needed */
  background: linear-gradient(135deg, #1aa4ff, #0d6efd); 
  color: #ffffff;
  padding: 30px 35px; 
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
  
}

header::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='0.1' d='M0,64L48,80C96,96,192,128,288,128C384,128,480,96,576,90.7C672,85,768,107,864,112C960,117,1056,107,1152,96C1248,85,1344,75,1392,69.3L1440,64L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z'%3E%3C/path%3E%3C/svg%3E") no-repeat;
  background-size: cover;
  z-index: 0;
  opacity: 0.3;
}

header h1 { 
  font-size: 2.5em; 
  font-weight: bold; 
  margin: 0; 
  position: relative;
  z-index: 1;
}

header #toggleMode {
  width: 50px; 
  height: 50px; 
  border: none;
  border-radius: 50%; 
  cursor: pointer; 
  font-size: 22px;
  display: flex; 
  align-items: center; 
  justify-content: center;
  background: rgba(255, 255, 255, 0.2);
  color: #ffffff; 
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  position: relative;
  z-index: 1;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  border: 2px solid rgba(255, 255, 255, 0.3);
}

header #toggleMode:hover { 
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.05);
}

/* Content Area */
.content-area { 
  flex-grow: 1; 
  display: flex; 
  overflow: hidden; 
}

.results-section {
  overflow-y: auto; 
  padding: 20px; 
  background: #ffffff; 
  width: 60%;
  box-shadow: inset 0 0 20px rgba(0,0,0,0.02);
}
    /* Data Entry Tab */
    .data-entry-tab {
      position: fixed; top: 50%; right: -320px; transform: translateY(-50%);
      width: 300px; background: #fff; border-left: 1px solid #009dff;
      box-shadow: -2px 0 8px rgba(0,0,0,0.2); z-index: 1000; transition: right 0.3s ease;
    }
    .data-entry-tab:hover { right: 0; }
    .data-entry-tab-header {
      position: absolute; top: 0; left: -40px; width: 40px; height: 100%;
      background: #2c3e50; color: #fff; text-align: center; line-height: 50px;
      writing-mode: vertical-rl; cursor: pointer; font-weight: bold;
      border-top-left-radius: 4px; border-bottom-left-radius: 4px;
    }
    .data-entry-tab-content { padding: 20px; overflow-y: auto; max-height: 90vh; }


/* Container Styles */
.container {
  background: #ffffff; 
  padding: 20px; 
  border-radius: 12px; 
  margin-bottom: 20px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.04);
  border: 1px solid rgba(0,0,0,0.03);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.container:hover {
  box-shadow: 0 8px 25px rgba(0,0,0,0.06);
  transform: translateY(-2px);
}

.container h2 {
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid rgba(26, 164, 255, 0.2);
  color: #11324b;
  font-weight: 600;
}

label { 
  display: block; 
  margin-top: 15px; 
  margin-bottom: 8px;
  color: #4b5563; 
  font-weight: 500;
  font-size: 0.95rem;
}

input[type="number"], input[type="text"], textarea, select {
  width: 100%; 
  padding: 12px 15px; 
  margin-top: 5px; 
  border: 1px solid #e5e7eb; 
  border-radius: 8px;
  background: #f9fafb;
  color: #374151;
  font-size: 1rem;
  transition: all 0.3s ease;
}

input[type="number"]:focus, input[type="text"]:focus, textarea:focus, select:focus {
  outline: none;
  border-color: #1aa4ff;
  box-shadow: 0 0 0 3px rgba(26, 164, 255, 0.1);
  background: #ffffff;
}

button {
  margin-top: 20px; 
  padding: 12px 16px; 
  width: 100%; 
  border: none;
  border-radius: 8px; 
  background: linear-gradient(135deg, #14d970, #0fae5d); 
  color: #fff;
  font-weight: 600; 
  cursor: pointer; 
  font-size: 16px;
  letter-spacing: 0.5px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(20, 217, 112, 0.2);
}

button:hover { 
  background: linear-gradient(135deg, #0fae5d, #14d970);  
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(20, 217, 112, 0.3);
}

.alt-btn { 
  background: linear-gradient(135deg, #e74c3c, #c0392b); 
  box-shadow: 0 4px 12px rgba(231, 76, 60, 0.2);
}

.alt-btn:hover { 
  background: linear-gradient(135deg, #c0392b, #e74c3c); 
  box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3);
}

.entry {
  border: 1px solid rgba(189, 195, 199, 0.2); 
  padding: 15px; 
  margin: 15px 0; 
  border-radius: 8px; 
  background: #f8fafc;
  transition: all 0.3s ease;
}

.entry:hover {
  box-shadow: 0 5px 15px rgba(0,0,0,0.05);
  transform: translateY(-2px);
}

/* User List in User Data Overlay */
.user-list { 
  margin-top: 25px; 
}
input[type="number"],
input[type="text"],
input[type="email"],
textarea,
select {
  width: 100%;
  padding: 12px 15px;
  margin-top: 5px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  background: #f9fafb;
  color: #42526c;
  font-size: 1rem;
  transition: all 0.3s ease;
}

input[type="number"]:focus,
input[type="text"]:focus,
input[type="email"]:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: #1aa4ff;
  box-shadow: 0 0 0 3px rgba(26, 164, 255, 0.1);
  background: #ffffff;
}

.user-item {
  display: flex; 
  align-items: center; 
  margin-bottom: 15px; 
  padding: 15px;
  border: 1px solid rgba(189, 195, 199, 0.2); 
  border-radius: 8px; 
  background: #f8fafc;
  transition: all 0.3s ease;
}

.user-item:hover {
  box-shadow: 0 5px 15px rgba(0,0,0,0.05);
  transform: translateY(-2px);
}

.user-photo {
  width: 60px; 
  height: 60px; 
  object-fit: cover; 
  border-radius: 12px;
  margin-right: 15px; 
  border: 3px solid #fff;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

.user-details { 
  flex-grow: 1; 
}

.delete-user-btn {
  background: linear-gradient(135deg, #e74c3c, #c0392b);
  border: none; 
  color: #fff; 
  padding: 8px 12px;
  cursor: pointer; 
  border-radius: 6px;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  font-weight: 600;
  box-shadow: 0 2px 8px rgba(231, 76, 60, 0.2);
}

.delete-user-btn:hover {
  background: linear-gradient(135deg, #c0392b, #e74c3c);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
}

/* Sidebar Overlay */
.sidebar-overlay {
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100vw; 
  height: 100vh;
  background: #ffffff; 
  overflow-y: auto; 
  padding: 140px 30px 30px;
  opacity: 0; 
  visibility: hidden; 
  transform: translateY(-20px);
  transition: opacity 0.5s ease, transform 0.5s ease, visibility 0.5s ease;
  z-index: 9999;
}

.sidebar-overlay.active {
  opacity: 1; 
  visibility: visible; 
  transform: translateY(0);
}

.sidebar-overlay::before {
  content: "";
  position: absolute; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 140px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%231aa4ff' fill-opacity='1' d='M0,64L48,80C96,96,192,128,288,128C384,128,480,96,576,90.7C672,85,768,107,864,112C960,117,1056,107,1152,96C1248,85,1344,75,1392,69.3L1440,64L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z'%3E%3C/path%3E%3C/svg%3E") no-repeat;
  background-size: cover; 
  z-index: -1;
}

.sidebar-overlay h2 {
  margin-bottom: 25px;
  color: #11324b;
  font-weight: 700;
  font-size: 1.8rem;
}

/* Dark Mode Styles */
body.dark-mode {
  background: #121212; 
  color: #e0e0e0;
}

body.dark-mode header {
  background: linear-gradient(135deg, #1565c0, #b71c1c); 
}

body.dark-mode .sidebar {
  background: linear-gradient(180deg, #1a1a1a, #2d2d2d);
  color: #e0e0e0; 
}

body.dark-mode .sidebar ul li:hover { 
  background: rgba(255, 255, 255, 0.1); 
}

body.dark-mode .results-section { 
  background: #1e1e1e; 
  color: #e0e0e0; 
}

body.dark-mode .container {
  background: #2d2d2d; 
  color: #e0e0e0; 
  border: 1px solid #3d3d3d;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

body.dark-mode .container h2 {
  border-bottom: 2px solid rgba(26, 115, 232, 0.3);
  color: #e0e0e0;
}

body.dark-mode .data-entry-tab { 
  background: #2d2d2d; 
  color: #e0e0e0; 
  border-left: 1px solid #3d3d3d; 
}

body.dark-mode .data-entry-tab-header { 
  background: linear-gradient(180deg, #1a1a1a, #2d2d2d);
}

body.dark-mode button {
  background: linear-gradient(135deg, #1a73e8, #d93025); 
  color: #ffffff; 
  box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
}

body.dark-mode button:hover {
  background: linear-gradient(135deg, #1669c1, #c5221f);
  box-shadow: 0 6px 15px rgba(26, 115, 232, 0.4);
}

body.dark-mode header #toggleMode {
  background: rgba(0, 0, 0, 0.3);
  color: #e0e0e0; 
  border: 2px solid rgba(255, 255, 255, 0.2);
}

body.dark-mode header #toggleMode:hover {
  background: rgba(0, 0, 0, 0.4);
}

body.dark-mode .entry, body.dark-mode .user-item {
  background: #333333;
  border: 1px solid #3d3d3d;
}

body.dark-mode input[type="number"], 
body.dark-mode input[type="text"], 
body.dark-mode textarea, 
body.dark-mode select {
  background: #3d3d3d;
  color: #e0e0e0;
  border: 1px solid #4d4d4d;
}

body.dark-mode input[type="number"]:focus, 
body.dark-mode input[type="text"]:focus, 
body.dark-mode textarea:focus, 
body.dark-mode select:focus {
  border-color: #1a73e8;
  box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
  background: #333333;
}

body.dark-mode .sidebar-overlay {
  background: #1e1e1e;
}

/* Custom Scrollbar */
::-webkit-scrollbar { width: 10px; }
::-webkit-scrollbar-track { background: #f0f0f0; }
::-webkit-scrollbar-thumb {
  background: #c0c0c0; 
  border-radius: 5px;
}
::-webkit-scrollbar-thumb:hover { background: #a0a0a0; }

body.dark-mode ::-webkit-scrollbar-track { background: #2d2d2d; }
body.dark-mode ::-webkit-scrollbar-thumb { background: #4d4d4d; }
body.dark-mode ::-webkit-scrollbar-thumb:hover { background: #5d5d5d; }
  </style>
  
</head>
<body>

  <div class="app-container">
    <!-- Sidebar Menu -->
    <div class="sidebar">
      <h2>Menu</h2>
      <ul>
        <li onclick="openSidebarOverlay('historyOverlay')">History</li>
        <li onclick="openSidebarOverlay('otherTestOverlay')">Games (Still making)</li>
        <li onclick="openSidebarOverlay('aiOverlay')">AI Analysis (Coming Soon)</li>
        <li onclick="openSidebarOverlay('userDataOverlay')">User Data</li>
        <li onclick="openSidebarOverlay('settingsOverlay')">Settings</li>
        
        <li onclick="window.location.href='samplewiki.html'">Wiki</li> <!-- New Wiki Tab -->
        <li onclick="window.location.href='piechart.html'">Our Data Survey</li> <!-- New Our Data Tab -->
      </ul>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
      <!-- Header with Wavy Text -->
      <header>
        <header>
          <h1 class="wavy-text">PEACFUL
          </h1>
        </header>
        <h3 style="font-size: 30px;color: #a1dbff;">Calm Mind, Happy Life</h3>
        <div style="display: flex; gap: 5px;">
          <button id="toggleMode" onclick="toggleDarkMode()">☾</button>
          <button id="toggleMode" onclick="window.location.href='newtestbar.html'">::</button>
          <button id="toggleMode" onclick="window.location.href='pie maer.html'">;;</button>
        </div>
        
        
      </header>
      
      
      <!-- Content Area: Left = Results, Right = Data Entry -->
      <div class="content-area">
        <!-- Results Section -->
        <div class="results-section">
       

          <div class="container">
            <h2>Report Summary</h2>
            <button type="button" onclick="generateReport()">Generate Report</button>
            <button type="button" onclick="sendReportToEmail()">Send Report to Email</button>
            <button type="button" onclick="downloadReport()">Download as Word File</button>
            <div id="reportResult" style="margin-top:20px;"></div>
          </div>

          
          <!-- Stored Entries -->
          <div class="container">
            <h2>Stored Entries</h2>
            <div id="entries"></div>
            <button type="button" onclick="clearEntries()">Clear All Entries</button>
          </div>
        </div>
        <div class="video-container">
          <video autoplay muted loop playsinline>
              <source src="Comp (1).mp4" type="video/mp4">
              Your browser does not support the video tag.
          </video>
      </div>
        <!-- Data Entry Tab -->
        <div class="data-entry-tab">
          <div class="data-entry-tab-header">Data Entry</div>
          <div class="data-entry-tab-content">
       <!-- Step 1: Physiological Data -->
<div id="step1" class="container">
  <h2>Enter Physiological Data</h2>
  <form id="physioForm">

    <!-- Select User Step -->
<div id="selectUserStep" class="container">
  <h2>Select User</h2>
  <label for="selectedUser">Choose a User:</label>
  <select id="selectedUser" onchange="enableDataEntry()">
      <option value="">-- Select a User --</option>
  </select>
  <button type="button" onclick="startDataEntry()">Next: Enter Data</button>
</div>

    
    <label for="systolicBP">Systolic Pressure (mmHg):</label>
    <input type="number" id="systolicBP" name="systolicBP" placeholder="e.g., 120" required>

    <label for="diastolicBP">Diastolic Pressure (mmHg):</label>
    <input type="number" id="diastolicBP" name="diastolicBP" placeholder="e.g., 80" required>

    <label for="sleepHours">Sleeping Hours:</label>
    <input type="number" id="sleepHours" name="sleepHours" placeholder="e.g., 7" required>

    <label for="heartRate">Beats per Minute (BPM):</label>
    <input type="number" id="heartRate" name="heartRate" placeholder="e.g., 70" required>

    <label for="breathsPerMin">Breaths per Minute:</label>
    <input type="number" id="breathsPerMin" name="breathsPerMin" placeholder="e.g., 16" required>

    <button type="button" onclick="calculatePhysiologicalStress()">Next: Calculate Stress</button>
  </form>
</div>

            <!-- Step 2: Emotional Assessment (Using Options) -->
            <div id="step2" class="container" style="display:none;">
              <h2>Emotional Assessment</h2>
              <p>Your rough stress level is: <strong><span id="roughStress"></span></strong></p>
              <form id="emotionalForm">
                <label for="feelingToday">How are you feeling today?</label>
                <select id="feelingToday" name="feelingToday" required>
                  <option value="">Select a rating</option>
                  <option value="1">1 - Very Bad</option>
                  <option value="2">2 - Bad</option>
                  <option value="3">3 - Neutral</option>
                  <option value="4">4 - Good</option>
                  <option value="5">5 - Very Good</option>
                </select>
                
                <label for="sleepRating">How's your sleep been?</label>
                <select id="sleepRating" name="sleepRating" required>
                  <option value="">Select a rating</option>
                  <option value="1">1 - Very Poor</option>
                  <option value="2">2 - Poor</option>
                  <option value="3">3 - Average</option>
                  <option value="4">4 - Good</option>
                  <option value="5">5 - Excellent</option>
                </select>
                
                <label for="manageableStress">How manageable is your stress?</label>
                <select id="manageableStress" name="manageableStress" required>
                  <option value="">Select a rating</option>
                  <option value="1">1 - Not Manageable</option>
                  <option value="3">3 - Neutral</option>
                  <option value="5">5 - Very Manageable</option>
                </select>
                
                <label for="socialConnections">Social connections feel...</label>
                <select id="socialConnections" name="socialConnections" required>
                  <option value="">Select a rating</option>
                  <option value="1">1 - Isolated</option>
                  <option value="3">3 - Neutral</option>
                  <option value="5">5 - Well Connected</option>
                </select>
                
                <label for="motivationLevel">Daily motivation level?</label>
                <select id="motivationLevel" name="motivationLevel" required>
                  <option value="">Select a rating</option>
                  <option value="1">1 - Low</option>
                  <option value="3">3 - Average</option>
                  <option value="5">5 - High</option>
                </select>
                
                <label for="jobType">What is your job?</label>
                <select id="jobType" name="jobType" required onchange="toggleStudyHours()">
                    <option value="">Select your job</option>
                    <option value="Teacher">Teacher</option>
                    <option value="Worker">Worker</option>
                    <option value="Student">Student</option>
                    <option value="Office Job">Office Job</option>
                </select>
        
                <!-- Study Hours Input (Hidden by Default) -->
<div id="studyHoursContainer" style="display: none;">
  <label for="studyHours">How many hours do you study per day?</label>
  <input type="number" id="studyHours" name="studyHours" placeholder="e.g.- 4">
</div>
                <button type="button" onclick="calculateFinalStress()">Next: Submit Answers</button>
              </form>
            </div>
          
            <!-- Step 3: Final Analysis and Recommendations -->
            <div id="step3" class="container" style="display:none;">
              <h2>Your Stress Analysis</h2>
              <p><strong>Final Stress Level:</strong> <span id="finalStress"></span></p>
              <h3>Recommended Therapies</h3>
              <ul id="therapies"></ul>
              <!-- Therapist recommendation will be appended here -->
              <p id="therapistRecommendation"></p>
              <!-- AI Integration Placeholder -->
              <div class="container" style="background:#e8f4fa; margin-top:20px;">
                <h4>AI Analysis</h4>
                <p>(AI integration will appear here)</p>
              </div>
              <button type="button" onclick="storeData()">Save Entry</button>
              <button type="button" class="alt-btn" onclick="resetTest()">Start Over</button>
            </div>
          </div>
        </div>
    
        <!-- Sidebar Overlay Views -->
        <div id="historyOverlay" class="sidebar-overlay">
          <h2>History</h2>
          <div id="sidebarEntries"></div>
          <button type="button" onclick="clearEntries()">Clear All Entries</button>
          <button type="button" onclick="closeSidebarOverlay()">Back</button>
        </div>
        <div id="otherTestOverlay" class="sidebar-overlay">
          <h2>Games</h2>
          <button style="font-size: 50px;display: inline-block;" onclick="window.location.href='gameselect.html'">Games</button>
          <button type="button" onclick="closeSidebarOverlay()">Back</button>
        </div>
        <div id="aiOverlay" class="sidebar-overlay">
          <h2>AI Analysis (Coming Soon)</h2>
          <button style="font-size: 50px;display: inline-block;" onclick="window.location.href='new.html'">AI</button>
          <button type="button" onclick="closeSidebarOverlay()">Back</button>
        </div>
        <!-- User Data Overlay -->
        <div id="userDataOverlay" class="sidebar-overlay">
          <h2>User Data</h2>
          <div class="container">
            <form id="userDataForm">
              <label for="userName">Name:</label>
              <input type="text" id="userName" name="userName" placeholder="Enter Name" required>

              <label for="userEmail">Email:</label>
              <input type="email" id="userEmail" name="userEmail" placeholder="Enter Email" required>
              
              <label for="userGender">Gender:</label>
<select id="userGender" name="userGender" required>
  <option value="">Select Gender</option>
  <option value="Male">Male</option>
  <option value="Female">Female</option>
</select>

              
              <label for="userPhone">Phone Number:</label>
              <input type="text" id="userPhone" name="userPhone" placeholder="Enter Phone Number" required>
              
              <label for="userQID">QID:</label>
              <input type="text" id="userQID" name="userQID" placeholder="Enter QID" required>
              
              <label for="userPhoto">Photo:</label>
              <input type="file" id="userPhoto" name="userPhoto" accept="image/*">
              
              <button type="button" onclick="saveUserData()">Save User Data</button>
            </form>
          </div>
          <!-- Render Saved Users -->
          <div class="container user-list" id="savedUsersList">
            <!-- Dynamically generated list of users will appear here -->
          </div>
          <button type="button" onclick="closeSidebarOverlay()">Back</button>
        </div>
      </div>
    </div>
    <div id="settingsOverlay" class="sidebar-overlay">
      <h2>Settings</h2>
      <div class="container">
        <label for="themeSelect">Select Theme:</label>
        <select id="themeSelect" onchange="changeTheme(this.value)">
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="blue">Blue</option>
          <option value="green">Green</option>
          <option value="red">Red</option>
        </select>
      </div>
      <button type="button" onclick="closeSidebarOverlay()">Back</button>
    </div>
    
    
    <script>

function changeTheme(theme) {
  // Remove any previously applied theme classes
  document.body.classList.remove('dark-mode', 'theme-blue', 'theme-green', 'theme-red');
  
  // Apply the new theme based on selection
  if (theme === 'dark') {
    document.body.classList.add('dark-mode');
  } else if (theme === 'blue') {
    document.body.classList.add('theme-blue');
  } else if (theme === 'green') {
    document.body.classList.add('theme-green');
  } else if (theme === 'red') {
    document.body.classList.add('theme-red');
  }
  // For 'light', no additional class is added.
}



function toggleStudyHours() {
    var jobType = document.getElementById("jobType").value;
    var studyHoursContainer = document.getElementById("studyHoursContainer");
    if (jobType === "Student") {
        studyHoursContainer.style.display = "block";
    } else {
        studyHoursContainer.style.display = "none";
    }
}

      // Ripple effect on click
      document.addEventListener('click', (e) => {
        const ripple = document.createElement('div');
        ripple.className = 'ripple';
        ripple.style.left = e.clientX + 'px';
        ripple.style.top = e.clientY + 'px';
        document.body.appendChild(ripple);
        setTimeout(() => { ripple.remove(); }, 600);
      });

      // Sidebar Overlay Functions
      function openSidebarOverlay(overlayId) {
        document.getElementById(overlayId).classList.add("active");
        if (overlayId === 'historyOverlay') { showSidebarEntries(); }
        if (overlayId === 'userDataOverlay') { renderSavedUsers(); }
      }
      function closeSidebarOverlay() {
        var overlays = document.getElementsByClassName("sidebar-overlay");
        for (var i = 0; i < overlays.length; i++) {
          overlays[i].classList.remove("active");
        }
      }
      
      function enableDataEntry() {
    var selectedUser = document.getElementById("selectedUser").value;
    document.getElementById("startDataEntryBtn").disabled = !selectedUser;
}

function startDataEntry() {
    var selectedUserIndex = document.getElementById("selectedUser").value;
    if (!selectedUserIndex) {
        alert("Please select a user before proceeding.");
        return;
    }
    
    // Hide user selection, show the first step
    document.getElementById("selectUserStep").style.display = "none";
    document.getElementById("step1").style.display = "block";
}
      function calculatePhysiologicalStress() {
  let systolic = parseInt(document.getElementById("systolicBP").value);
  let diastolic = parseInt(document.getElementById("diastolicBP").value);
  let sleep = parseInt(document.getElementById("sleepHours").value);
  let heartRate = parseInt(document.getElementById("heartRate").value);
  let breaths = parseInt(document.getElementById("breathsPerMin").value);

  if (isNaN(systolic) || isNaN(diastolic) || isNaN(sleep) || isNaN(heartRate) || isNaN(breaths)) {
    alert("Please enter all physiological values correctly.");
    return;
  }

  let physStressLevel = 0;

  if (systolic <= 110 && diastolic <= 70 && sleep >= 8 && heartRate <= 65 && breaths <= 15) {
    physStressLevel = 1; // Low Stress
  } 
  else if (systolic <= 130 && diastolic <= 85 && sleep >= 6 && heartRate <= 80 && breaths <= 20) {
    physStressLevel = 2; // Medium Stress
  } 
  else if (systolic <= 150 && diastolic <= 95 && sleep >= 4 && heartRate <= 95 && breaths <= 30) {
    physStressLevel = 3; // High Stress
  } 
  else {
    physStressLevel = 4; // Extreme Stress
  }

  document.getElementById("roughStress").textContent = physStressLevel;
  document.getElementById("step1").style.display = "none";
  document.getElementById("step2").style.display = "block";
}


      
function calculateFinalStress() {
    var roughStress = parseInt(document.getElementById('roughStress').textContent);

    // Retrieve job type and emotional ratings
    var jobType = document.getElementById('jobType').value;
    var feelingToday = parseFloat(document.getElementById('feelingToday').value);
    var sleepRating = parseFloat(document.getElementById('sleepRating').value);
    var manageableStress = parseFloat(document.getElementById('manageableStress').value);
    var socialConnections = parseFloat(document.getElementById('socialConnections').value);
    var motivationLevel = parseFloat(document.getElementById('motivationLevel').value);

    if (!jobType || isNaN(feelingToday) || isNaN(sleepRating) || isNaN(manageableStress) || isNaN(socialConnections) || isNaN(motivationLevel)) {
        alert("Please complete all emotional questions.");
        return;
    }

    // Calculate an emotional stress score
    var emotionalStress = (6 - feelingToday) + (6 - sleepRating) + (6 - manageableStress) + (6 - socialConnections) + (6 - motivationLevel);
    var emotionalAdjustment = Math.round((emotionalStress - 5) / 2);

    // Adjust stress level based on job type
    var jobStressModifier = 0;
    if (jobType === "Teacher") jobStressModifier = 2;
    else if (jobType === "Worker") jobStressModifier = 1;
    else if (jobType === "Student") jobStressModifier = 1;
    else if (jobType === "Office Job") jobStressModifier = 3;

    var finalStress = roughStress + emotionalAdjustment + jobStressModifier;

    // Display final stress level
    document.getElementById('finalStress').textContent = finalStress;

    // Update recommendations
    var therapiesList = document.getElementById('therapies');
    therapiesList.innerHTML = "";
    var therapist = "";

    if (finalStress <= 8) {
        therapiesList.innerHTML = "<li>Deep breathing exercises</li><li>Light exercise or a walk</li>";
        therapist = "Wellness Coach";
    } else if (finalStress <= 12) {
        therapiesList.innerHTML = "<li>Meditation and mindfulness</li><li>Yoga or stretching</li><li>Talk to a friend</li>";
        therapist = "Stress Management Counselor";
    } else {
        therapiesList.innerHTML = "<li>Consult a professional therapist</li><li>Consider stress management workshops</li><li>Engage in regular relaxation techniques</li>";
        therapist = "Clinical Psychologist";
    }

    document.getElementById('therapistRecommendation').innerHTML = "<strong>Recommended Therapist:</strong> " + therapist;

    // Move to step 3
    document.getElementById('step2').style.display = "none";
    document.getElementById('step3').style.display = "block";
}

      
      // Save User Data with Photo Functionality
      function saveUserData() {
        var user = {
          name: document.getElementById('userName').value,
          gender: document.getElementById('userGender').value,
          phone: document.getElementById('userPhone').value,
          qid: document.getElementById('userQID').value,
          photo: null
        };
        var photoInput = document.getElementById('userPhoto');
        if(photoInput.files && photoInput.files[0]){
          var reader = new FileReader();
          reader.onload = function(e) {
            user.photo = e.target.result; // Base64 image
            finishSaveUser(user);
          }
          reader.readAsDataURL(photoInput.files[0]);
        } else {
          finishSaveUser(user);
        }
      }
      function finishSaveUser(user) {
        var users = localStorage.getItem('userData');
        users = users ? JSON.parse(users) : [];
        users.push(user);
        localStorage.setItem('userData', JSON.stringify(users));
        alert("User data saved!");
        document.getElementById('userDataForm').reset();
        loadUsers(); // Refresh the dropdown in the physiological data form
        renderSavedUsers(); // Refresh the saved users list
      }

     function saveUserData() {
  var user = {
    name: document.getElementById('userName').value,
    email: document.getElementById('userEmail').value,
    gender: document.getElementById('userGender').value,
    phone: document.getElementById('userPhone').value,
    qid: document.getElementById('userQID').value,
    photo: null
  };
  var photoInput = document.getElementById('userPhoto');
  if (photoInput.files && photoInput.files[0]) {
    var reader = new FileReader();
    reader.onload = function(e) {
      user.photo = e.target.result; // Base64 image
      finishSaveUser(user);
    };
    reader.readAsDataURL(photoInput.files[0]);
  } else {
    finishSaveUser(user);
  }
}

function finishSaveUser(user) {
  var users = localStorage.getItem('userData');
  users = users ? JSON.parse(users) : [];
  users.push(user);
  localStorage.setItem('userData', JSON.stringify(users));
  alert("User data saved!");
  document.getElementById('userDataForm').reset();
  loadUsers(); // Refresh the dropdown
  renderSavedUsers(); // Refresh the saved users list
}
function sendReportToEmail() {
  var selectedUserIndex = document.getElementById('selectedUser').value;
  if (!selectedUserIndex) {
    alert("Please select a user from the dropdown.");
    return;
  }

  var users = localStorage.getItem('userData');
  users = users ? JSON.parse(users) : [];
  var selectedUser = users[selectedUserIndex];

  if (!selectedUser || !selectedUser.email) {
    alert("Please select a user with a valid email address.");
    return;
  }

  var reportContent = document.getElementById('reportResult').innerHTML;
  if (reportContent.trim() === "") {
    alert("Please generate the report first.");
    return;
  }

  // Simulate sending the email (replace with actual backend integration)
  alert(`Report sent to ${selectedUser.email}`);
  console.log("Report Content:", reportContent); // For debugging
}
      
function loadUsers() {
  var userSelect = document.getElementById('selectedUser');
  userSelect.innerHTML = '<option value="">-- Select a User --</option>'; // Reset dropdown
  var users = localStorage.getItem('userData');
  users = users ? JSON.parse(users) : [];
  users.forEach(function(user, index) {
    var option = document.createElement('option');
    option.value = index; // Use index as the value
    option.textContent = user.name + " (" + user.email + ")"; // Display name and email
    userSelect.appendChild(option);
  });
}
      
      // Render Saved Users in the User Data Overlay with Delete Buttons
      function renderSavedUsers() {
        var container = document.getElementById('savedUsersList');
        var users = localStorage.getItem('userData');
        users = users ? JSON.parse(users) : [];
        container.innerHTML = "";
        if(users.length === 0){
          container.innerHTML = "<p>No users saved yet.</p>";
          return;
        }
        users.forEach(function(user, index){
          var userDiv = document.createElement('div');
          userDiv.className = "user-item";
          if(user.photo){
            var img = document.createElement('img');
            img.src = user.photo;
            img.alt = user.name + " Photo";
            img.className = "user-photo";
            userDiv.appendChild(img);
          }
          var detailsDiv = document.createElement('div');
          detailsDiv.className = "user-details";
          detailsDiv.innerHTML = "<strong>" + user.name + "</strong><br>" + user.phone;
          userDiv.appendChild(detailsDiv);
          var deleteBtn = document.createElement('button');
          deleteBtn.textContent = "Delete";
          deleteBtn.className = "delete-user-btn";
          deleteBtn.onclick = function(){ deleteUser(index); };
          userDiv.appendChild(deleteBtn);
          container.appendChild(userDiv);
        });
      }
      
      // Delete a user from localStorage
      function deleteUser(index) {
        if(confirm("Are you sure you want to delete this user?")){
          var users = localStorage.getItem('userData');
          users = users ? JSON.parse(users) : [];
          users.splice(index, 1);
          localStorage.setItem('userData', JSON.stringify(users));
          loadUsers();
          renderSavedUsers();
        }
      }
      
      function storeData() {
    var selectedUserIndex = document.getElementById('selectedUser') ? document.getElementById('selectedUser').value : "";
    var users = localStorage.getItem('userData');
    var selectedUser = (users && selectedUserIndex !== "") ? JSON.parse(users)[selectedUserIndex] : null;

    var entry = {
        timestamp: new Date().toLocaleString(),
        systolicBP: document.getElementById('systolicBP').value,
        diastolicBP: document.getElementById('diastolicBP').value,
        sleepHours: document.getElementById('sleepHours').value,
        heartRate: document.getElementById('heartRate').value,
        breathsPerMin: document.getElementById('breathsPerMin').value,
        roughStress: document.getElementById('roughStress').textContent,
        finalStress: document.getElementById('finalStress').textContent,
        feelingToday: document.getElementById('feelingToday').value,
        sleepRating: document.getElementById('sleepRating').value,
        manageableStress: document.getElementById('manageableStress').value,
        socialConnections: document.getElementById('socialConnections').value,
        motivationLevel: document.getElementById('motivationLevel').value,
        recommendedTherapist: document.getElementById('therapistRecommendation').textContent.replace("Recommended Therapist: ", ""),
        user: selectedUser
    };

    if (!entry.systolicBP || !entry.diastolicBP || !entry.sleepHours || !entry.heartRate || !entry.breathsPerMin) {
        alert("Please fill in all required fields.");
        return;
    }

    var entries = localStorage.getItem('stressEntries');
    entries = entries ? JSON.parse(entries) : [];
    entries.push(entry);
    localStorage.setItem('stressEntries', JSON.stringify(entries));

    alert("Entry saved successfully!");
    resetTest();
    showEntries();

    function storeData() {
    var selectedUserIndex = document.getElementById('selectedUser').value;
    var users = localStorage.getItem('userData');
    var selectedUser = (users && selectedUserIndex !== "") ? JSON.parse(users)[selectedUserIndex] : null;

    if (!selectedUser) {
        alert("No user selected. Please select a user before entering data.");
        return;
    }

    var entry = {
        timestamp: new Date().toLocaleString(),
        userName: selectedUser.name,  // Save username
        userEmail: selectedUser.email,  // Save email
        systolicBP: document.getElementById('systolicBP').value,
        diastolicBP: document.getElementById('diastolicBP').value,
        sleepHours: document.getElementById('sleepHours').value,
        heartRate: document.getElementById('heartRate').value,
        breathsPerMin: document.getElementById('breathsPerMin').value,
        roughStress: document.getElementById('roughStress').textContent,
        finalStress: document.getElementById('finalStress').textContent,
        feelingToday: document.getElementById('feelingToday').value,
        sleepRating: document.getElementById('sleepRating').value,
        manageableStress: document.getElementById('manageableStress').value,
        socialConnections: document.getElementById('socialConnections').value,
        motivationLevel: document.getElementById('motivationLevel').value,
        recommendedTherapist: document.getElementById('therapistRecommendation').textContent.replace("Recommended Therapist: ", "")
    };

    var entries = localStorage.getItem('stressEntries');
    entries = entries ? JSON.parse(entries) : [];
    entries.push(entry);
    localStorage.setItem('stressEntries', JSON.stringify(entries));

    alert(`Entry saved for ${selectedUser.name} (${selectedUser.email})!`);
    resetTest();
    showEntries();
}

}

      
      function resetTest() {
        document.getElementById('physioForm').reset();
        document.getElementById('emotionalForm').reset();
        document.getElementById('step1').style.display = "block";
        document.getElementById('step2').style.display = "none";
        document.getElementById('step3').style.display = "none";
      }
      
      // Data View Functions (Results Section)
      function loadEntries() {
        var entries = localStorage.getItem('stressEntries');
        return entries ? JSON.parse(entries) : [];
      }
      function loadEntriesToDiv(divId) {
        var container = document.getElementById(divId);
        var entries = loadEntries();
        container.innerHTML = "";
        if (entries.length === 0) {
          container.innerHTML = "<p>No entries stored yet.</p>";
        } else {
          entries.forEach(function(entry) {
            var div = document.createElement('div');
            div.className = "entry";
            div.innerHTML = "<strong>Date:</strong> " + entry.timestamp + "<br>" +
                            (entry.user ? "<strong>User:</strong> " + entry.user.name + "<br>" : "<strong>User:</strong> N/A<br>") +
                            "<strong>Heart Rate:</strong> " + entry.heartRate + " bpm<br>" +
                            "<strong>Blood Pressure:</strong> " + entry.bloodPressure + "<br>" +
                            "<strong>Respiratory Rate:</strong> " + entry.respiratoryRate + " breaths/min<br>" +
                            "<strong>Rough Stress Level:</strong> " + entry.roughStress + "<br>" +
                            "<strong>Final Stress Level:</strong> " + entry.finalStress + "<br>" +
                            "<strong>Feeling Today:</strong> " + entry.feelingToday + "<br>" +
                            "<strong>Sleep Rating:</strong> " + entry.sleepRating + "<br>" +
                            "<strong>Manageable Stress:</strong> " + entry.manageableStress + "<br>" +
                            "<strong>Social Connections:</strong> " + entry.socialConnections + "<br>" +
                            "<strong>Motivation Level:</strong> " + entry.motivationLevel + "<br>" +
                            "<strong>Recommended Therapist:</strong> " + entry.recommendedTherapist;
            container.appendChild(div);
          });
        }
      }
      function showEntries() { loadEntriesToDiv('entries'); }
      function clearEntries() {
        if (confirm("Are you sure you want to clear all stored entries?")) {
          localStorage.removeItem('stressEntries');
          showEntries();
          loadEntriesToDiv('sidebarEntries');
        }
        function showEntries() {
    var container = document.getElementById('entries');
    var entries = localStorage.getItem('stressEntries');
    entries = entries ? JSON.parse(entries) : [];
    container.innerHTML = "";
    if (entries.length === 0) {
        container.innerHTML = "<p>No entries stored yet.</p>";
        return;
    }

    entries.forEach(function(entry) {
        var div = document.createElement('div');
        div.className = "entry";
        div.innerHTML = `<strong>Date:</strong> ${entry.timestamp}<br>
                         <strong>User:</strong> ${entry.userName} (${entry.userEmail})<br>
                         <strong>Systolic BP:</strong> ${entry.systolicBP} mmHg<br>
                         <strong>Diastolic BP:</strong> ${entry.diastolicBP} mmHg<br>
                         <strong>Heart Rate:</strong> ${entry.heartRate} bpm<br>
                         <strong>Breaths/Min:</strong> ${entry.breathsPerMin}<br>
                         <strong>Final Stress Level:</strong> ${entry.finalStress}<br>
                         <strong>Recommended Therapist:</strong> ${entry.recommendedTherapist}`;
        container.appendChild(div);
    });
}

      }
      
      // Generate Report Function
      function generateReport() {
        var entries = loadEntries();
        var reportDiv = document.getElementById('reportResult');
        reportDiv.innerHTML = "";
        if (entries.length === 0) {
          reportDiv.innerHTML = "<p>No data available to generate a report.</p>";
          return;
        }
        var totalEntries = entries.length;
        var sumHeartRate = 0, sumRespRate = 0, sumFinalStress = 0;
        entries.forEach(function(entry) {
          sumHeartRate += parseFloat(entry.heartRate);
          sumRespRate += parseFloat(entry.respiratoryRate);
          sumFinalStress += parseFloat(entry.finalStress);
        });
        var avgHeartRate = (sumHeartRate / totalEntries).toFixed(1);
        var avgRespRate = (sumRespRate / totalEntries).toFixed(1);
        var avgFinalStress = (sumFinalStress / totalEntries).toFixed(1);
        var reportHTML = "<h1 class='report-title'>Stress Analysis Report</h1>";
        reportHTML += "<h2 class='section-title'>Overall Summary</h2>";
        reportHTML += "<p>Total Entries: " + totalEntries + "</p>";
        reportHTML += "<p>Average Heart Rate: " + avgHeartRate + " bpm</p>";
        reportHTML += "<p>Average Respiratory Rate: " + avgRespRate + " breaths/min</p>";
        reportHTML += "<p>Average Final Stress Level: " + avgFinalStress + "</p>";
        reportDiv.innerHTML = reportHTML;
      }
      
      // Download Report as Word File Function with Enhanced Styles
      function downloadReport() {
        var reportContent = document.getElementById('reportResult').innerHTML;
        if(reportContent.trim() === ""){
          alert("Please generate the report first.");
          return;
        }
        // Enhanced Word-compatible HTML with inline CSS for better formatting
        var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                     "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                     "xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Stress Analysis Report</title>" +
                     "<style>" +
                     "body { font-family: 'Segoe UI', sans-serif; margin: 40px; }" +
                     "h1.report-title { text-align: center; font-size: 24pt; color: #11324b; margin-bottom: 20px; }" +
                     "h2.section-title { font-size: 18pt; color: #0d8bf2; border-bottom: 2px solid #1aa4ff; padding-bottom: 5px; margin-top: 30px; }" +
                     "p { font-size: 12pt; line-height: 1.5; margin-top: 10px; }" +
                     "</style>" +
                     "</head><body>";
        var footer = "</body></html>";
        var sourceHTML = header + reportContent + footer;
        var blob = new Blob(['\ufeff', sourceHTML], { type: 'application/msword' });
        var url = URL.createObjectURL(blob);
        var link = document.createElement('a');
        link.href = url;
        link.download = 'StressReport.doc';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
      
      // For Sidebar History Overlay
      function showSidebarEntries() { loadEntriesToDiv('sidebarEntries'); }
      
      // Resizable Divider (if needed)
      (function() {
        const resizer = document.querySelector('.resizer');
        const contentArea = document.querySelector('.content-area');
        const resultsSection = document.querySelector('.results-section');
        let isResizing = false;
    
        resizer && resizer.addEventListener('mousedown', function(e) {
          isResizing = true;
        });
    
        document.addEventListener('mousemove', function(e) {
          if (!isResizing) return;
          const contentRect = contentArea.getBoundingClientRect();
          let newResultsWidth = e.clientX - contentRect.left;
          if(newResultsWidth < 50) newResultsWidth = 50;
          if(newResultsWidth > contentRect.width - 50 - (resizer ? resizer.offsetWidth : 0)) {
            newResultsWidth = contentRect.width - 50 - (resizer ? resizer.offsetWidth : 0);
          }
          resultsSection.style.width = newResultsWidth + 'px';
        });
    
        document.addEventListener('mouseup', function(e) {
          isResizing = false;
        });
      })();
      
      // Dark Mode Toggle Function with Icon Change
      function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        const toggleButton = document.getElementById('toggleMode');
        if(document.body.classList.contains('dark-mode')){
            toggleButton.innerHTML = '☀';
        } else {
            toggleButton.innerHTML = '☾';
        }
      }
      
      // Load initial entries and users on page load
      window.onload = function() {
        showEntries();
        loadUsers();
      }
    </script>
</body>
</html>
